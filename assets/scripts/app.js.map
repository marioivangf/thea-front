{"version":3,"sources":["functions.js"],"names":["update_form_styles","document","getElementById","bg_color","value","accent_color","darken_accent_color","tinycolor","darken","shadow","getBrightness","style_sheet","isDark","toString","write_styles","classList","toggle","style_id","css_text","style_el","getElementsByTagName","removeChild","createElement","type","id","innerHTML","appendChild","not_responsive_check","w","window","innerWidth","body","each_node_evt","selector","cb","nodes","querySelectorAll","_","each","node","addEventListener","each_node_evt_init_once","onetime","callback","e","target","removeEventListener","arguments","callee","dataset","pathName","event","input","currentTarget","sync_target","syncedInput","trim","textContent","placeholder","parentNode","parentClassToggle","stopPropagation","parent_clist","state_class","contains","remove","add","image","querySelector","files","reader","FileReader","onload","src","result","readAsDataURL","impostor","style","backgroundColor","Dropdown","Tabule","opts_string","sticker","Sticker","JSON","parse","Chart","defaults","global","title","display","gender_chart_dom","getContext","options","maintainAspectRatio","text","data","labels","datasets","age_chart_dom","label","patients_chart_dom","questions_source","dragula_containers","i","block","push","drake","dragula","copy","el","source","on","element","container","s","console","log"],"mappings":"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","file":"app.js","sourcesContent":["(function () {\n\n  // GLOBALS\n  var path_name = document.body.dataset.pathName;\n\n  // Not responsive validation\n  window.addEventListener('resize', not_responsive_check, true);\n  not_responsive_check();\n\n  // Sync input with else text\n  each_node_evt(\"[data-synced-input]\", \"keyup\", function (event) {\n    var input = event.currentTarget;\n    var sync_target = document.getElementById(input.dataset.syncedInput);\n    var value = input.value.trim();\n    sync_target.classList.toggle(\"clean\", value === \"\")\n    sync_target.textContent = (value === \"\") ? input.placeholder : value;\n  });\n\n  // Toggle password in inputs\n  each_node_evt(\"[data-password-toggle]\", \"mousedown\", function (event) {\n    var input = event.currentTarget.parentNode.getElementsByTagName(\"INPUT\")[0];\n    input.type = \"text\";\n  });\n  each_node_evt(\"[data-password-toggle]\", \"mouseup\", function (event) {\n    var input = event.currentTarget.parentNode.getElementsByTagName(\"INPUT\")[0];\n    input.type = \"password\";\n  });\n\n  // Toggle classes in parents\n  each_node_evt(\"[data-parent-class-toggle]\", \"click\", function (event) {\n    var target = event.currentTarget;\n    target.parentNode.classList.toggle(target.dataset.parentClassToggle);\n  });\n\n  // Toggle classes for dropdowns\n  each_node_evt(\"[data-dropdown-toggle]\", \"click\", function (event) {\n    event.stopPropagation();\n    var parent_clist = event.currentTarget.parentNode.classList;\n    var state_class = \"dropdown--opened\";\n    if (parent_clist.contains(state_class))\n      parent_clist.remove(state_class);\n    else {\n      parent_clist.add(state_class);\n      onetime(document, \"click\", function () {\n        parent_clist.remove(state_class);\n      });\n    }\n  });\n\n  // Image inputs with preview\n  each_node_evt(\"[data-image-input] input[type='file']\", \"change\", function (event) {\n\n    var input = event.currentTarget;\n    var image = input.parentNode.querySelector(\"img\");\n    if (input.files && input.files[0]) {\n      var reader = new FileReader();\n      reader.onload = function (e) {\n        input.parentNode.classList.remove(\"clean\");\n        image.src = e.target.result;\n      }\n      reader.readAsDataURL(input.files[0]);\n    }\n  });\n\n  // Form styles update\n  each_node_evt_init_once(\"[data-appform-style-trigger]\", \"change\", update_form_styles);\n\n  // Color inputs\n  _(document.querySelectorAll(\"[data-input-color]\")).each(function (node) {\n    var input = node.querySelector(\"[data-input]\");\n    var impostor = node.querySelector(\"[data-impostor]\");\n    input.addEventListener(\"change\", function (event) {\n      impostor.style.backgroundColor = input.value;\n    }, false);\n    impostor.style.backgroundColor = input.value;\n  })\n\n  // Dropdown inititalization\n  _(document.querySelectorAll(\"[data-dd]\")).each(function (node) {\n    new Dropdown(node);\n  })\n\n  // Tabule inititalization\n  _(document.querySelectorAll(\"[data-tabule]\")).each(function (node) {\n    new Tabule(node);\n  })\n\n  // Sticker JS init\n  _(document.querySelectorAll(\"[data-sticker]\")).each(function (node) {\n    var opts_string = node.dataset.sticker || \"{}\";\n    new Sticker(node, JSON.parse(opts_string));\n  });\n\n  // Forms Statistics\n  Chart.defaults.global.title.display = true;\n\n  var gender_chart_dom = document.getElementById(\"pie-chart\");\n  if (gender_chart_dom) {\n    var gender_chart = new Chart(gender_chart_dom.getContext('2d'), {\n      type: 'doughnut',\n      options: {\n        maintainAspectRatio: false,\n        title: { text: \"GÃ©nero de los pacientes\" }\n      },\n      data: {\n        labels: [\"Mujeres\", \"Hombres\"],\n        datasets: [{\n          backgroundColor: [\n            \"#34495e\",\n            \"#3498db\"\n        //         \"#2ecc71\",\n        // \"#3498db\",\n        // \"#95a5a6\",\n        // \"#9b59b6\",\n        // \"#f1c40f\",\n        // \"#e74c3c\",\n        // \"#34495e\"\n          ],\n          data: [522, 323]\n        }]\n      }\n    });\n  }\n\n  var age_chart_dom = document.getElementById('age-chart');\n  if (age_chart_dom) {\n    var age_chart = new Chart(age_chart_dom.getContext('2d'), {\n      type: 'bar',\n      options: {\n        maintainAspectRatio: false,\n        title: { text: \"Edad promedio de los pacientes\" }\n      },\n      data: {\n        labels: ['M', 'T', 'W', 'T', 'F', 'S', 'S'],\n        datasets: [{\n          label: 'Mujeres',\n          data: [12, 19, 3, 17, 6, 3, 7],\n          backgroundColor: \"#34495e\"\n        }, {\n          label: 'Hombres',\n          data: [2, 29, 5, 5, 2, 3, 10],\n          backgroundColor: \"#3498db\"\n        }]\n      }\n    });\n  }\n\n  var patients_chart_dom = document.getElementById('patients-chart');\n  if (patients_chart_dom) {\n    var patients_chart = new Chart(patients_chart_dom.getContext('2d'), {\n      type: 'line',\n      options: {\n        maintainAspectRatio: false,\n        title: {\n          text: \"Promedio de encuestados\"\n        }\n      },\n      data: {\n        labels: ['M', 'T', 'W', 'T', 'F', 'S', 'S'],\n        datasets: [{\n          label: 'Encuestados',\n          data: [40, 19, 42, 17, 56, 12, 38],\n          backgroundColor: \"#34495e\"\n        }]\n      }\n    });\n  }\n\n  // Dragula on forms construction\n  var questions_source = document.getElementById(\"questions-source\");\n\n  if (questions_source) {\n\n    var dragula_containers = [questions_source];\n    for (var i = 1; i < 5; i++) {\n      var block = document.getElementById(\"visit-block-\"+i);\n      dragula_containers.push(block);\n    }\n\n    var drake = dragula(dragula_containers, {\n      copy: function (el, source) {\n        return source.id === \"questions-source\";\n      }\n    });\n\n    drake.on(\"drop\", function (element, container, src, s) {\n      //drake.cancel(true);\n      console.log(s);\n      // Change the model here to refresh the view\n    });\n  }\n\n  function update_form_styles () {\n\n    if (!document.getElementById(\"af-bg-color\")) return;\n    var bg_color = document.getElementById(\"af-bg-color\").value;\n    var accent_color = document.getElementById(\"af-accent-color\").value;\n    var darken_accent_color = tinycolor(accent_color).darken(5);\n    var shadow = (tinycolor(bg_color).getBrightness() < 120) ? \"rgba(255, 255, 255, 0.2)\" : \"rgba(0, 0, 0, 0.1)\";\n    // Background color\n    var style_sheet = \".af-bg { background-color: \"+bg_color+\"; }\\n\";\n    // Accent color (like labels text)\n    style_sheet += \".af-accent { color: \"+accent_color+\"; }\\n\";\n    // Buttons\n    style_sheet += \".af-button { background-color: \"+accent_color+\";\\n\";\n    style_sheet += \"color: \"+(darken_accent_color.isDark() ? \"#FFFFFF\" : \"rgba(0, 0, 0, 0.8)\")+\"; }\\n\";\n    style_sheet += \".af-button:hover, .af-button:focus { background-color: \"+darken_accent_color.toString()+\";\";\n    style_sheet += \"box-shadow: -6px 6px 0 \"+shadow+\"; }\\n\";\n    style_sheet += \".af-button, .af-button:active { box-shadow: 0px 0px 0 \"+shadow+\"; }\";\n    // Inputs\n    style_sheet += \".af-input { box-shadow: 0px 0px 0 \"+shadow+\"; }\";\n    style_sheet += \".af-input:focus { box-shadow: -6px 6px 0 \"+shadow+\"; }\";\n    // Separator\n    style_sheet += \".af-separator { border-color: \"+accent_color+\"; }\\n\";\n    // Write styles\n    write_styles(\"af-styles\", style_sheet);\n    document.getElementById(\"af-container\").classList.toggle(\"af--dark\", tinycolor(bg_color).isDark());\n  }\n\n  // Write styles directly for form customization\n  function write_styles (style_id, css_text) {\n    var style_el = document.getElementById(style_id);\n    if (style_el) document.getElementsByTagName(\"head\")[0].removeChild(style_el);\n    style_el = document.createElement('style');\n    style_el.type = \"text/css\";\n    style_el.id = style_id;\n    style_el.innerHTML = css_text;\n    document.getElementsByTagName(\"head\")[0].appendChild(style_el);\n  }\n\n  function not_responsive_check () {\n    var w = window.innerWidth;\n    document.body.classList.toggle(\"not-responsive-notice\", w < 980);\n  }\n\n  function each_node_evt (selector, type, cb) {\n    var nodes = document.querySelectorAll(selector);\n    _(nodes).each(function (node) {\n      node.addEventListener(type, cb);\n    });\n  }\n\n  function each_node_evt_init (selector, type, cb) {\n    var nodes = document.querySelectorAll(selector);\n    _(nodes).each(function (node) {\n      node.addEventListener(type, cb);\n      cb();\n    });\n  }\n\n  function each_node_evt_init_once (selector, type, cb) {\n    var nodes = document.querySelectorAll(selector);\n    _(nodes).each(function (node) {\n      node.addEventListener(type, cb);\n    });\n    cb();\n  }\n\n  function onetime (node, type, callback) {\n    // create event\n    node.addEventListener(type, function (e) {\n      // remove event\n      e.target.removeEventListener(e.type, arguments.callee);\n      // call handler\n      return callback(e);\n    });\n  }\n\n  function nodes_to_arr (nodes) {\n    return Array.prototype.slice.call(nodes);\n  }\n\n})();"]}